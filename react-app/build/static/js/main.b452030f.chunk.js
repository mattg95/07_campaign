(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{102:function(e,t,n){},110:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),r=n(19),s=n.n(r),i=n(22),o=n(4),d=n(25),l=n(50),j=n.n(l),m=n(51),p=n.n(m),b=n(112),u=n(113),h=n(114),O=n(52),x=function(e){var t=e.passDataUpstream,n=Object(c.useRef)(null),r=document.getElementById("displayMP");return Object(c.useEffect)((function(){O.makeWidget(n.current,"https://z8ivgb8lhnl.typeform.com/to/YbkRDwtc",{hideFooter:!0,hideHeaders:!0,opacity:0,onSubmit:function(e){var n=e.response_id;t({responseId:n}),setTimeout((function(){r&&r.scrollIntoView()}),3e3)}})}),[n,r,t]),Object(a.jsx)("div",{children:Object(a.jsx)("div",{ref:n,className:"typeform-widget ",id:"typeform"})})},f=n(53),v=n(54),y=(n(98),function(e){var t=e.emailBody,n=e.passDataUpstream;return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{className:"secondary-header",children:"3.Edit your email"}),Object(a.jsx)(f.a,{viewContainerClassName:"emailBox",type:"textarea",inputProps:{placeholder:"your email will appear here",rows:10},saveButtonContent:"Apply",cancelButtonContent:Object(a.jsx)("strong",{children:"Cancel"}),editButtonContent:"Edit Your Email",value:t,onSave:function(e){n({generatedEmail:e})}}),Object(a.jsx)(v.a,{trigger:function(e){return Object(a.jsx)("button",{className:"btn btn-outline-primary copy-button",children:"Copy"})},closeOnDocumentClick:!0,onOpen:function(){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(e),n({copied:!0})},className:"copy-popup",children:Object(a.jsx)("span",{children:" Copied to clipboard "})})]})})}),g=n(33),N=n.n(g),E=n(55),C=n(26),w=function(e){var t=e.passDataUpstream,n=Object(c.useState)({dropDownOpen:!1,postcodeError:""}),r=Object(d.a)(n,2),s=r[0],i=r[1],l=s.dropDownOpen,j=s.postcodeError,m=function(){var e=Object(E.a)(N.a.mark((function e(n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/postcode/".concat(n),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.error?i(Object(o.a)(Object(o.a)({},s),{},{postcodeError:e.error})):(t({mpData:e}),i(Object(o.a)(Object(o.a)({},s),{},{postcodeError:""})))}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){var t=e.postcode;/([A-Z][A-HJ-Y]?[0-9][A-Z0-9]? ?[0-9][A-Z]{2}|GIR ?0A{2})$/.test(t.toUpperCase())?m(t):t.length>5&&i(Object(o.a)(Object(o.a)({},s),{},{postcodeError:"Invalid postcode"}))};return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"button-container",children:[Object(a.jsx)("button",{className:"btn btn-lg cta btn-outline-primary",type:"submit",onClick:function(){return i(Object(o.a)(Object(o.a)({},s),{},{dropDownOpen:!0}))},children:"Don't see your MP?"}),Object(a.jsx)("a",{href:"#emailBox",children:Object(a.jsx)("button",{className:"btn btn-lg cta btn-primary",type:"submit",onClick:function(){return i(Object(o.a)(Object(o.a)({},s),{},{dropDownOpen:!1}))},children:"Continue with this MP"})})]}),l&&Object(a.jsx)(C.c,{initialValues:{postcode:""},validate:p,onSubmit:p,children:function(e){return Object(a.jsxs)(C.b,{className:"get-MP-form",children:[Object(a.jsx)("label",{htmlFor:"postcode",children:"Postcode:"}),Object(a.jsx)(C.a,{type:"text",name:"postcode"}),Object(a.jsx)("div",{className:"error postcode-error",children:j||""})]})}})]})},D=function(e){var t=e.mpData,n=t.constituency,c=t.full_name,r=t.party,s=t.name,i=t.error,o=e.mpEmailAddress;return Object(a.jsxs)("div",{className:"displayMP",id:"displayMP",children:[Object(a.jsx)("h2",{className:"secondary-header",children:"2. Find Your MP"}),Object(a.jsxs)("div",{className:"mpCard text-center",children:[Object(a.jsx)("div",{className:"error",children:i}),Object(a.jsx)("div",{children:n}),Object(a.jsx)("div",{children:s}),Object(a.jsx)("div",{children:c}),Object(a.jsx)("div",{children:r}),Object(a.jsx)("div",{children:o})]})]})},B=function(e){var t=e.subject,n=e.body,c=e.mpEmailAddress;return Object(a.jsxs)("div",{className:"send-email",children:[Object(a.jsx)("h2",{className:"secondary-header",children:"4. Send your email"}),Object(a.jsx)("p",{className:"explanation",children:"This will open your email service in a different window"}),Object(a.jsx)("a",{href:"mailto:"+c+"?Subject="+encodeURIComponent(t)+"&Body="+encodeURIComponent(n),className:"btn btn-primary btn-lg cta send-button",target:"_blank",rel:"noreferrer",children:"SEND EMAIL"})]})},A=function(){return Object(a.jsxs)("div",{className:"intro-content",children:[Object(a.jsx)("h1",{className:"title",children:"0.7% Campaign"}),Object(a.jsx)("p",{className:"intro-para",children:'The 2019 Conservative Manifesto declared Britain would "proudly maintain our commitment to spend 0.7 per cent of GNI on development". But just one year later, the government intends to cut foreign aid indefinitely. At a time of unprecedented international crisis, with millions at risk of extreme poverty, Britain must show leadership - not break its commitments.'}),Object(a.jsxs)("div",{className:"",children:[Object(a.jsx)("h2",{className:"secondary-header",children:"1. Fill out the survey to email your MP"}),Object(a.jsxs)("p",{className:"explanation",children:[Object(a.jsx)("strong",{children:"We will draft an email"})," based on your survey responses,",Object(a.jsx)("strong",{children:"written to have the maximum impact on your MP."})," With your help we can safeguard the support so many need."]})]})]})};n(102);n(103).config({path:"../.env"});var k=p()(),I=function(){var e=Object(c.useState)({responseId:"",mpData:{error:"Could not find MP"},generatedEmailBody:"Your email will appear here",emailSubject:"",positiveTypeFormResponseReturned:!1,mpEmailAddress:"",greeting:"",emailWithGreeting:""}),t=Object(d.a)(e,2),n=t[0],r=t[1],s=n.responseId,l=n.mpData,m=n.generatedEmailBody,p=n.emailSubject,O=n.mpEmailAddress,f=n.greeting,v=n.emailWithGreeting,g=n.positiveTypeFormResponseReturned;Object(c.useEffect)((function(){k.on("typeform-incoming",(function(e){var t=e.formToken,a=e.generatedEmail;t===s&&(console.log(a),r(Object(o.a)(Object(o.a)({},n),{},{generatedEmailBody:a.body,emailSubject:a.subject,mpData:a.mpData,greeting:a.greeting,emailWithGreeting:a.greeting+a.body,positiveTypeFormResponseReturned:a.supportsAid})))}))}),[s]),Object(c.useEffect)((function(){r(Object(o.a)(Object(o.a)({},n),{},{emailWithGreeting:f+m}))}),[m,f]),Object(c.useEffect)((function(){if(l){var e=l.name,t=l.full_name,a=t||e;a&&r(Object(o.a)(Object(o.a)({},n),{},{mpEmailAddress:a.toLowerCase().replace(" ",".")+".mp@parliament.uk",greeting:"Dear ".concat(a,",\n")}))}}),[l]);var N=function(e){Object.keys(e).forEach((function(t){r(Object(o.a)(Object(o.a)({},n),{},Object(i.a)({},t,e[t])))}))};return Object(a.jsx)(j.a,{children:Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(b.a,{children:[Object(a.jsx)(u.a,{children:Object(a.jsx)(h.a,{children:Object(a.jsx)(A,{})})}),Object(a.jsx)(u.a,{children:Object(a.jsx)(h.a,{children:Object(a.jsx)("div",{className:"typeform",children:Object(a.jsx)(x,{passDataUpstream:N})})})}),g&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(u.a,{children:Object(a.jsx)(h.a,{children:Object(a.jsx)("div",{className:"",children:Object(a.jsx)(D,{mpData:l,mpEmailAddress:O})})})}),Object(a.jsx)(u.a,{children:Object(a.jsx)(h.a,{children:Object(a.jsx)("div",{id:"mpForm",className:"",children:Object(a.jsx)(w,{passDataUpstream:N})})})}),Object(a.jsx)(u.a,{children:Object(a.jsx)(h.a,{children:Object(a.jsx)("div",{id:"emailBox",className:"",children:Object(a.jsx)(y,{passDataUpstream:N,emailBody:v,subject:p})})})}),Object(a.jsx)(u.a,{children:Object(a.jsx)(h.a,{children:Object(a.jsx)("div",{className:"",children:Object(a.jsx)(B,{mpEmailAddress:O,body:v,subject:p})})})})]})]})})})},M=n(58),P=n.n(M),F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,115)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};n(109);P.a.initialize({gtmId:"GTM-MWBT83W"}),s.a.render(Object(a.jsx)(I,{}),document.getElementById("root")),F()}},[[110,1,2]]]);
//# sourceMappingURL=main.b452030f.chunk.js.map