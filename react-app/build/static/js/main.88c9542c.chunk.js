(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),r=n(19),s=n.n(r),i=n(22),o=n(4),d=n(25),l=n(50),j=n.n(l),b=n(104),m=n(105),p=n(106),u=n(51),O=function(e){var t=e.passDataUpstream,n=Object(a.useRef)(null),r=document.getElementById("displayMP");return Object(a.useEffect)((function(){u.makeWidget(n.current,"https://z8ivgb8lhnl.typeform.com/to/YbkRDwtc",{hideFooter:!0,hideHeaders:!0,opacity:0,onSubmit:function(e){var n=e.response_id;t({responseId:n}),setTimeout((function(){r&&r.scrollIntoView()}),3e3)}})}),[n,r,t]),Object(c.jsx)("div",{children:Object(c.jsx)("div",{ref:n,className:"typeform-widget ",id:"typeform"})})},h=n(52),x=n(53),f=(n(93),function(e){var t=e.emailBody,n=e.passDataUpstream;return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{className:"secondary-header",children:"3.Edit your email"}),Object(c.jsx)(h.a,{viewContainerClassName:"emailBox",type:"textarea",inputProps:{placeholder:"your email will appear here",rows:10},saveButtonContent:"Apply",cancelButtonContent:Object(c.jsx)("strong",{children:"Cancel"}),editButtonContent:"Edit Your Email",value:t,onSave:function(e){n({generatedEmail:e})}}),Object(c.jsx)(x.a,{trigger:function(e){return Object(c.jsx)("button",{className:"btn btn-outline-primary copy-button",children:"Copy"})},closeOnDocumentClick:!0,onOpen:function(){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(e),n({copied:!0})},className:"copy-popup",children:Object(c.jsx)("span",{children:" Copied to clipboard "})})]})})}),v=n(33),y=n.n(v),g=n(54),E=n(26),N=function(e){var t=e.passDataUpstream,n=Object(a.useState)({dropDownOpen:!1,postcodeError:""}),r=Object(d.a)(n,2),s=r[0],i=r[1],l=s.dropDownOpen,j=s.postcodeError,b=function(){var e=Object(g.a)(y.a.mark((function e(n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/postcode/".concat(n),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.error?i(Object(o.a)(Object(o.a)({},s),{},{postcodeError:e.error})):(t({mpData:e}),i(Object(o.a)(Object(o.a)({},s),{},{postcodeError:""})))}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(e){var t=e.postcode;/([A-Z][A-HJ-Y]?[0-9][A-Z0-9]? ?[0-9][A-Z]{2}|GIR ?0A{2})$/.test(t.toUpperCase())?b(t):t.length>5&&i(Object(o.a)(Object(o.a)({},s),{},{postcodeError:"Invalid postcode"}))};return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"button-container",children:[Object(c.jsx)("button",{className:"btn btn-lg cta btn-outline-primary",type:"submit",onClick:function(){return i(Object(o.a)(Object(o.a)({},s),{},{dropDownOpen:!0}))},children:"Don't see your MP?"}),Object(c.jsx)("a",{href:"#emailBox",children:Object(c.jsx)("button",{className:"btn btn-lg cta btn-primary",type:"submit",onClick:function(){return i(Object(o.a)(Object(o.a)({},s),{},{dropDownOpen:!1}))},children:"Continue with this MP"})})]}),l&&Object(c.jsx)(E.c,{initialValues:{postcode:""},validate:m,onSubmit:m,children:function(e){return Object(c.jsxs)(E.b,{className:"get-MP-form",children:[Object(c.jsx)("label",{htmlFor:"postcode",children:"Postcode:"}),Object(c.jsx)(E.a,{type:"text",name:"postcode"}),Object(c.jsx)("div",{className:"error postcode-error",children:j||""})]})}})]})},C=function(e){var t=e.mpData,n=t.constituency,a=t.full_name,r=t.party,s=t.name,i=t.error,o=e.mpEmailAddress;return Object(c.jsxs)("div",{className:"displayMP",id:"displayMP",children:[Object(c.jsx)("h2",{className:"secondary-header",children:"2. Find Your MP"}),Object(c.jsxs)("div",{className:"mpCard text-center",children:[Object(c.jsx)("div",{className:"error",children:i}),Object(c.jsx)("div",{children:n}),Object(c.jsx)("div",{children:s}),Object(c.jsx)("div",{children:a}),Object(c.jsx)("div",{children:r}),Object(c.jsx)("div",{children:o})]})]})},D=function(e){var t=e.subject,n=e.body,a=e.mpEmailAddress;return Object(c.jsxs)("div",{className:"send-email",children:[Object(c.jsx)("h2",{className:"secondary-header",children:"4. Send your email"}),Object(c.jsx)("p",{className:"explanation",children:"This will open your email service in a different window"}),Object(c.jsx)("a",{href:"mailto:"+a+"?Subject="+encodeURIComponent(t)+"&Body="+encodeURIComponent(n),className:"btn btn-primary btn-lg cta send-button",target:"_blank",rel:"noreferrer",children:"SEND EMAIL"})]})},w=function(){return Object(c.jsxs)("div",{className:"intro-content",children:[Object(c.jsx)("h1",{className:"title",children:"0.7% Campaign"}),Object(c.jsx)("p",{className:"intro-para",children:"Info about our campaign. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}),Object(c.jsxs)("div",{className:"",children:[Object(c.jsx)("h2",{className:"secondary-header",children:"1. Fill out the form"}),Object(c.jsx)("p",{className:"explanation",children:"This will generate an email to send to your MP"})]})]})};n(97);n(98).config({path:"../.env"});var A=j()(),B=function(){var e=Object(a.useState)({responseId:"",mpData:{error:"Could not find MP"},generatedEmailBody:"Your email will appear here",emailSubject:"",typeFormReturned:!1,mpEmailAddress:"",greeting:"",emailWithGreeting:""}),t=Object(d.a)(e,2),n=t[0],r=t[1],s=n.responseId,l=n.mpData,j=n.generatedEmailBody,u=n.emailSubject,h=n.mpEmailAddress,x=n.greeting,v=n.emailWithGreeting,y=n.typeFormReturned;Object(a.useEffect)((function(){A.on("typeform-incoming",(function(e){var t=e.formToken,c=e.generatedEmail;t===s&&r(Object(o.a)(Object(o.a)({},n),{},{generatedEmailBody:c.body,emailSubject:c.subject,mpData:c.mpData,greeting:c.greeting,typeFormReturned:!0}))}))}),[s]),Object(a.useEffect)((function(){r(Object(o.a)(Object(o.a)({},n),{},{emailWithGreeting:x+j}))}),[j,x]),Object(a.useEffect)((function(){if(l){var e=l.name,t=l.full_name,c=t||e;c&&r(Object(o.a)(Object(o.a)({},n),{},{mpEmailAddress:c.toLowerCase().replace(" ",".")+".mp@parliament.uk",greeting:"Dear ".concat(c,",\n")}))}}),[l]);var g=function(e){Object.keys(e).forEach((function(t){r(Object(o.a)(Object(o.a)({},n),{},Object(i.a)({},t,e[t])))}))};return Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)(b.a,{children:[Object(c.jsx)(m.a,{children:Object(c.jsx)(p.a,{xs:12,lg:6,children:Object(c.jsx)(w,{})})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(p.a,{children:Object(c.jsx)("div",{className:"typeform",children:Object(c.jsx)(O,{passDataUpstream:g})})})}),y&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(m.a,{children:Object(c.jsx)(p.a,{children:Object(c.jsx)("div",{className:"",children:Object(c.jsx)(C,{mpData:l,mpEmailAddress:h})})})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(p.a,{children:Object(c.jsx)("div",{id:"mpForm",className:"",children:Object(c.jsx)(N,{passDataUpstream:g})})})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(p.a,{children:Object(c.jsx)("div",{id:"emailBox",className:"",children:Object(c.jsx)(f,{passDataUpstream:g,emailBody:v,subject:u})})})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(p.a,{children:Object(c.jsx)("div",{className:"",children:Object(c.jsx)(D,{mpEmailAddress:h,body:v,subject:u})})})})]})]})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,107)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};n(101);s.a.render(Object(c.jsx)(B,{}),document.getElementById("root")),F()},97:function(e,t,n){}},[[102,1,2]]]);
//# sourceMappingURL=main.88c9542c.chunk.js.map