(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{112:function(e,t,n){},117:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n(0),r=n(21),a=n.n(r),s=n(55),o=n.n(s),l=n(27),d=n(57),j=n.n(d),b=n(24),u=n(3),m=n(18),p=n(58),h=n.n(p),O=n(120),x=n(118),f=n(119),v=n(37),y=function(e){var t=e.passDataUpstream,n=e.isMobile,r=Object(i.useRef)(null),a=Object(i.useRef)(null),s=Object(i.useState)(!0),o=Object(m.a)(s,2),l=o[0],d=o[1],j=v.makePopup("https://z8ivgb8lhnl.typeform.com/to/YbkRDwtc",{mode:"popup",openValue:50,autoClose:3,onSubmit:function(e){var n=e.response_id;t({responseId:n})}});return Object(i.useEffect)((function(){!n&&v.makeWidget(r.current,"https://z8ivgb8lhnl.typeform.com/to/YbkRDwtc",{hideScrollbars:!0,opacity:0,onSubmit:function(e){var n=e.response_id;t({responseId:n}),setTimeout((function(){d(!1)}),3e3)}})}),[r,t,n]),Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"call-to-action text-center",children:[Object(c.jsxs)("button",{ref:a,onClick:function(){n?j.open():r.current.scrollIntoView({behavior:"smooth",block:"end"})},className:"btn btn-primary btn-lg main-cta",children:["Fill out the survey to email your MP"," "]}),Object(c.jsxs)("p",{className:"explanation",children:[Object(c.jsx)("strong",{children:"We will draft an email"})," based on your survey responses,"," ",Object(c.jsx)("strong",{children:"written to have the maximum impact on your MP."})," With your help we can safeguard the support so many need."]})]}),Object(c.jsx)("div",{ref:r,className:"typeform-widget ".concat(l?"":"closed"),id:"typeform"})]})},g=n(59),w=n(60),E=(n(108),function(e){var t=e.emailBody,n=e.passDataUpstream;return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{className:"secondary-header",children:"3.Edit your email"}),Object(c.jsx)(g.a,{viewContainerClassName:"emailBox",type:"textarea",inputProps:{placeholder:"your email will appear here",rows:10},saveButtonContent:"Apply",cancelButtonContent:Object(c.jsx)("strong",{children:"Cancel"}),editButtonContent:"Edit Your Email",value:t,onSave:function(e){n({generatedEmail:e})}}),Object(c.jsx)(w.a,{trigger:function(e){return Object(c.jsx)("button",{className:"btn btn-outline-primary copy-button",children:"Copy"})},closeOnDocumentClick:!0,onOpen:function(){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(e),n({copied:!0})},className:"copy-popup",children:Object(c.jsx)("span",{children:" Copied to clipboard "})})]})})}),N=n(38),D=n.n(N),C=n(61),k=n(28),B=function(e){var t=e.passDataUpstream,n=e.emailBoxRef,r=e.emailVisible,a=Object(i.useState)({dropDownOpen:!1,postcodeError:""}),s=Object(m.a)(a,2),o=s[0],l=s[1],d=o.dropDownOpen,j=o.postcodeError,b=Object(i.useRef)();Object(i.useEffect)((function(){var e=b.current;e&&e.scrollIntoView({behavior:"smooth",block:"end"}),window.scrollBy(0,100)}),[d]),Object(i.useEffect)((function(){var e=n.current;e&&e.scrollIntoView({behavior:"smooth",block:"start"})}),[r,n]);var p=function(){var e=Object(C.a)(D.a.mark((function e(n){var c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/postcode/".concat(n),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.error?l(Object(u.a)(Object(u.a)({},o),{},{postcodeError:e.error})):(t({mpData:e}),l(Object(u.a)(Object(u.a)({},o),{},{postcodeError:""})))}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(e){var t=e.postcode;/([A-Z][A-HJ-Y]?[0-9][A-Z0-9]? ?[0-9][A-Z]{2}|GIR ?0A{2})$/.test(t.toUpperCase())?p(t):t.length>5&&l(Object(u.a)(Object(u.a)({},o),{},{postcodeError:"Invalid postcode"}))};return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"button-container",id:"postcodeDropdown",children:[Object(c.jsx)("button",{className:"btn btn-lg cta btn-outline-primary left-button",type:"submit",onClick:function(e){e.preventDefault(),l(Object(u.a)(Object(u.a)({},o),{},{dropDownOpen:!0}))},children:"Don't see your MP?"}),Object(c.jsx)("button",{className:"btn btn-lg cta btn-primary right-button ",type:"submit",onClick:function(e){e.preventDefault(),l(Object(u.a)(Object(u.a)({},o),{},{dropDownOpen:!1})),t({emailVisible:!0})},children:"Yes, continue with this MP"})]}),d&&Object(c.jsx)(k.c,{initialValues:{postcode:""},validate:h,onSubmit:h,children:function(e){return Object(c.jsxs)(k.b,{className:"get-MP-form",id:"postcodeDropdown",ref:b,children:[Object(c.jsx)("label",{htmlFor:"postcode",children:"Postcode:"}),Object(c.jsx)(k.a,{type:"text",name:"postcode"}),Object(c.jsx)("div",{className:"error postcode-error",children:j||""})]})}})]})},R=function(e){var t=e.mpData,n=t.constituency,i=t.full_name,r=t.party,a=t.name,s=t.error,o=e.mpEmailAddress;return Object(c.jsxs)("div",{className:"displayMP",id:"displayMP",children:[Object(c.jsx)("h2",{className:"secondary-header",children:"2. Find Your MP"}),Object(c.jsxs)("div",{className:"mpCard text-center",children:[Object(c.jsx)("div",{className:"error",children:s}),Object(c.jsx)("div",{children:n}),Object(c.jsx)("div",{children:a}),Object(c.jsx)("div",{children:i}),Object(c.jsx)("div",{children:r}),Object(c.jsx)("div",{className:"mpEmailAddress",children:o})]})]})},A=function(e){var t=e.subject,n=e.body,i=e.mpEmailAddress;return Object(c.jsxs)("div",{className:"send-email",children:[Object(c.jsx)("h2",{className:"secondary-header",children:"4. Send your email"}),Object(c.jsx)("p",{className:"explanation",children:"This will open your email service in a different window"}),Object(c.jsx)("a",{href:"mailto:"+i+"?Subject="+encodeURIComponent(t)+"&Body="+encodeURIComponent(n),className:"btn btn-primary btn-lg cta send-button",target:"_blank",rel:"noreferrer",children:"SEND EMAIL"})]})},P=function(){return Object(c.jsxs)("div",{className:"intro-content",children:[Object(c.jsx)("h1",{className:"title",children:"The 0.7% Campaign"}),Object(c.jsxs)("p",{className:"intro-para",children:["The 2019 Conservative Manifesto declared Britain would"," ",Object(c.jsx)("strong",{children:'"proudly maintain our commitment to spend 0.7 per cent of GNI on development"'}),". But just one year later, the government intends to cut foreign aid indefinitely.",Object(c.jsx)("br",{}),Object(c.jsx)("br",{})," At a time of unprecedented international crisis, with millions at risk of extreme poverty,"," ",Object(c.jsx)("strong",{children:"Britain must show leadership - not break its commitments."})]})]})},I=function(){return Object(c.jsxs)("div",{id:"Footer",children:[Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("h3",{className:"text-center",children:"The 0.7% Campaign"})})}),Object(c.jsxs)(x.a,{children:[Object(c.jsxs)(f.a,{xs:12,lg:6,children:[Object(c.jsx)(l.a,{to:"privacy-policy",children:"Privacy Policy"}),"Who we are"]}),Object(c.jsxs)(f.a,{xs:12,lg:6,children:[Object(c.jsx)("a",{href:"mailto:email@example.com",children:"email@example.com"}),Object(c.jsx)("a",{href:"https://concepts.effectivealtruism.org/concepts/aid-effectiveness/",children:"Further reading on aid"})]})]})]})};n(112);n(113).config({path:"../.env"});var S=h()(),T=function(){var e=Object(i.useState)({width:window.innerWidth,responseId:"",mpData:{error:"Could not find MP",name:"",full_name:""},generatedEmailBody:"Your email will appear here",emailSubject:"",positiveTypeFormResponseReturned:!1,mpEmailAddress:"",greeting:"",emailWithGreeting:"",emailVisible:!1}),t=Object(m.a)(e,2),n=t[0],r=t[1],a=n.responseId,s=n.mpData,o=n.generatedEmailBody,l=n.emailSubject,d=n.mpEmailAddress,j=n.greeting,p=n.emailWithGreeting,h=n.positiveTypeFormResponseReturned,v=n.width,g=n.emailVisible,w=Object(i.useRef)(null),N=Object(i.useRef)(null),D=function(e){if(!e.error){var t=e.name,n=e.full_name;return(n||t).toLowerCase().replace(" ",".").replace("'","")+".mp@parliament.uk"}};Object(i.useEffect)((function(){S.on("typeform-incoming",(function(e){var t=e.formToken,c=e.generatedEmail;t===a&&r(Object(u.a)(Object(u.a)({},n),{},{generatedEmailBody:c.body,emailSubject:c.subject,mpData:c.mpData,greeting:c.greeting,mpEmailAddress:D(c.mpData),emailWithGreeting:c.greeting+c.body,positiveTypeFormResponseReturned:c.supportsAid}))}))}),[a]),Object(i.useEffect)((function(){if(s){var e=s.name,t=s.full_name,c=t||e;c&&r(Object(u.a)(Object(u.a)({},n),{},{mpEmailAddress:D(s),greeting:"Dear ".concat(c,",\n")}))}}),[s.name,s.full_name]),Object(i.useEffect)((function(){r(Object(u.a)(Object(u.a)({},n),{},{emailWithGreeting:j+o}))}),[o,j]);var C=function(){r(Object(u.a)(Object(u.a)({},n),{},{width:window.innerWidth}))};Object(i.useEffect)((function(){return window.addEventListener("resize",C),function(){window.removeEventListener("resize",C)}}),[]);var k=v&&v<=768;Object(i.useEffect)((function(){setTimeout((function(){var e=w.current;e&&k&&h&&e.scrollIntoView({behavior:"smooth",block:"start"})}),3e3)}),[w,h]);var T=function(e){Object.keys(e).forEach((function(t){r(Object(u.a)(Object(u.a)({},n),{},Object(b.a)({},t,e[t])))}))};return Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:"app-body",children:Object(c.jsxs)(O.a,{children:[Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)(P,{})})}),Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("div",{className:"typeform",children:Object(c.jsx)(y,{passDataUpstream:T,isMobile:k})})})}),h&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("div",{ref:w,children:Object(c.jsx)(R,{mpData:s,mpEmailAddress:d})})})}),Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("div",{id:"mpForm",className:"",children:Object(c.jsx)(B,{passDataUpstream:T,emailBoxRef:N,emailVisible:g})})})}),g&&Object(c.jsxs)("div",{children:[Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("div",{ref:N,children:Object(c.jsx)(E,{passDataUpstream:T,emailBody:p,subject:l})})})}),Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("div",{className:"",children:Object(c.jsx)(A,{mpEmailAddress:d,body:p,subject:l})})})})]})]})]})}),Object(c.jsx)("div",{className:"footer",children:Object(c.jsx)(O.a,{children:Object(c.jsx)(I,{})})})]})},M=function(){return Object(c.jsx)("div",{className:"privacy-policy",children:Object(c.jsxs)(O.a,{children:[Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("h1",{children:"Privacy Policy"})})}),Object(c.jsx)(x.a,{children:Object(c.jsx)(f.a,{children:Object(c.jsx)("p",{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."})})})]})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,121)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),r(e),a(e)}))};n(116);o.a.initialize({gtmId:"GTM-MWBT83W"}),a.a.render(Object(c.jsx)(j.a,{children:Object(c.jsxs)(l.b,{children:[Object(c.jsx)(T,{path:"/"}),Object(c.jsx)(M,{path:"/privacy-policy"})]})}),document.getElementById("root")),F()}},[[117,1,2]]]);
//# sourceMappingURL=main.a1daa25d.chunk.js.map